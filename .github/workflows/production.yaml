# https://javascript.works-hub.com/learn/how-to-create-a-ci-slash-cd-pipeline-using-netlify-and-github-actions-90aeb
name: "Build Pipeline"
on: 
  push:
    branches:
    - main
jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - uses: actions/checkout@v3.2.0
    - name: Use Node.js 16.x
      uses: actions/setup-node@v3
      with:
        node-version: 16.x
        cache: 'npm'
        cache-dependency-path: package-lock.json
    - name: Install dependencies
      run: npm install     
    - name: Build
      run: npm run pbuild
    - name: Commit
      run: |
        git config --global user.name 'John M. Wargo'
        git config --global user.email 'johnwargo@users.noreply.github.com'
        git commit -am "Automated Build (GitHub Actions)"
    - name: Push
      uses: ad-m/github-push-action@master
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        branch: ${{ github.ref }} 
    - name: Curl request
      run: curl -X POST -d {} https://api.netlify.com/build_hooks/64430b2915a2690352879b28


